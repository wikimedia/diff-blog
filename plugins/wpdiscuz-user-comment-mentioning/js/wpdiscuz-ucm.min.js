jQuery(document).ready(function(e){function t(t){e.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_user",wcm_user_id:t}}).done(function(t){try{!function(t){var i="";if(t.error)i=t.error;else{var n=t.avatar,c=t.user_name,o=t.post_count,u=t.comment_count,a=t.description;i="<div class='ucm-info-header'>"+n,i+="<div class='ucm-right'> <div class='ucm-user-name'>"+c+"</div>",i+="<div class='ucm-counts-wrap'><div class='ucm-post-count'>"+wpdiscuzAjaxObj.wpdumc_text_posts+": "+o+"</div>",i+="<div class='ucm-comment-count'>"+wpdiscuzAjaxObj.wpdumc_text_comments+": "+u+"</div> </div> </div></div>",a&&(i+='<div class=\'ucm-discription\'><i class="fas fa-quote-left" aria-hidden="true"></i> '+a+'<i class="fas fa-quote-right" aria-hidden="true"></div>')}e(".user-tooltip").html(i)}(e.parseJSON(t))}catch(e){console.log(e)}})}function i(t){e.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_comment_info",wcm_comment_id:t}}).done(function(t){try{!function(t){var i="";if(t.error)i=t.error;else{var n=t.avatar,c=t.user_name,o=t.comment;i="<div class='ucm-info-header'>"+n,i+=" <div class='ucm-user-name'>"+c+"</div></div>",o&&(i+='<div class=\'ucm-discription\'><i class="fas fa-quote-left" aria-hidden="true"></i> '+o+' <i class="fas fa-quote-right" aria-hidden="true"></div>')}e(".user-tooltip").html(i)}(e.parseJSON(t))}catch(e){console.log(e)}})}function n(){e("body").children(".user-tooltip").hasClass("user-tooltip")||e("body").append("<div class='user-tooltip'><i class='fa fa-spinner fa-spin' style='font-size:24px;color:#888'></i></div>")}e(function(){var c,o;e(document).delegate(".hint","mouseover",function(){c!==e(this).data("ucm_user_id")&&(c=e(this).data("ucm_user_id")),""!==c&&t(c)}),e(document).delegate(".ucm-comment-id","mouseover",function(){o!==e(this).text()&&(o=e(this).text()),""!==o&&i(o)}),e(document).delegate(".ucm-comment-id","mousemove",function(t){var i=window.innerWidth,n=window.innerHeight,c=t.pageX+20,o=t.pageY+20;i<400?c=(i-200)/2:i-t.pageX<200&&(c=t.pageX-200),n-(t.pageY-e(window).scrollTop())<200&&(o=t.pageY-90),e(".user-tooltip").css({top:o,left:c}).show()}),e(document).delegate(".ucm-comment-id","mouseover",function(){n()}),e(document).delegate(".ucm-comment-id","mouseout",function(){e(".user-tooltip").remove()}),e(document).delegate(".hint","mousemove",function(t){var i=window.innerWidth,n=window.innerHeight,c=t.pageX+20,o=t.pageY+20;i<400?c=(i-200)/2:i-t.pageX<200&&(c=t.pageX-200),n-(t.pageY-e(window).scrollTop())<200&&(o=t.pageY-90),e(".user-tooltip").css({top:o,left:c}).show()}),e(document).delegate(".hint","mouseout",function(){e(".user-tooltip").remove()}),e(document).delegate(".hint","mouseover",function(){n()})}),e(document).delegate(".ucm-comment-id","click",function(){var t=e(this).text().replace("#","");0===e("body").find("#comment-"+t).length&&window.location.reload(!0)})});let wpdumcItems,wpdumcCachequery=new Map,wpdumcSearchTerm="",wpdumcReng=null,wpdumcRenderListXHR=null;function wpdiscuzUMCRenderList(e,t,i){e.length>0?wpdumcCachequery.has(e)?t(wpdumcCachequery.get(e),e):(null!==wpdumcRenderListXHR&&wpdumcRenderListXHR.abort(),wpdumcRenderListXHR=jQuery.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_all_users",key_name:e,post_id:wpdiscuzAjaxObj.wc_post_id}}).done(function(i){try{let n=jQuery.parseJSON(i);if("number"!=typeof n){let i=jQuery.makeArray(n);wpdumcCachequery.set(e,i),t(i,e)}else t([],e)}catch(e){console.log(e)}})):t([],e)}function wpdUMCInsertItem(e,t){let i=wpDiscuzEditor.currentEditor,n=null,c=" @"+e.value+" ";null!==i&&(n=wpdumcReng.index-(wpdumcSearchTerm.length+1),i.deleteText(n,wpdumcSearchTerm.length+1,Quill.sources.USER),i.insertText(n,c,Quill.sources.USER),i.setSelection(n+c.length,Quill.sources.USER))}function wpdUMCRenderItem(e,t){wpdumcSearchTerm=t;let i=wpDiscuzEditor.currentEditor;return i.emitter.emit(["editor-change",null,null,"user"]),wpdumcReng=i.getSelection(),`<div title="${wpdiscuzAjaxObj.wpdumc_displayNicename?`@${e.value}`:""}"><span class="us-av">${e.avatar}</span><span class="us-dn">${e.display_name}</span></div>`}