
(function(h,C,k){var F=h(document),c,i,l,t,E="",j,o,z,n,y,f,D,b="touchmove.a mousemove.a pointermove.a",A="touchstart.a mousedown.a pointerdown.a",I="touchend.a mouseup.a pointerup.a",B=false,x=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(J){J()},d='<div class="cp-color-picker"><div class="cp-z-slider"><div class="cp-z-cursor"></div></div><div class="cp-xy-slider"><div class="cp-white"></div><div class="cp-xy-cursor"></div></div><div class="cp-alpha"><div class="cp-alpha-cursor"></div></div></div>',r=".cp-color-picker{position:absolute;overflow:hidden;padding:6px 6px 0;background-color:#444;color:#bbb;font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:400;cursor:default;border-radius:5px}.cp-color-picker>div{position:relative;overflow:hidden}.cp-xy-slider{float:left;height:128px;width:128px;margin-bottom:6px;background:linear-gradient(to right,#FFF,rgba(255,255,255,0))}.cp-white{height:100%;width:100%;background:linear-gradient(rgba(0,0,0,0),#000)}.cp-xy-cursor{position:absolute;top:0;width:10px;height:10px;margin:-5px;border:1px solid #fff;border-radius:100%;box-sizing:border-box}.cp-z-slider{float:right;margin-left:6px;height:128px;width:20px;background:linear-gradient(red 0,#f0f 17%,#00f 33%,#0ff 50%,#0f0 67%,#ff0 83%,red 100%)}.cp-z-cursor{position:absolute;margin-top:-4px;width:100%;border:4px solid #fff;border-color:transparent #fff;box-sizing:border-box}.cp-alpha{clear:both;width:100%;height:16px;margin:6px 0;background:linear-gradient(to right,#444,rgba(0,0,0,0))}.cp-alpha-cursor{position:absolute;margin-left:-4px;height:100%;border:4px solid #fff;border-color:#fff transparent;box-sizing:border-box}",a=function(J){l=this.color=new C(J);t=l.options};a.prototype={render:e,toggle:v};function m(J){return J.value||J.getAttribute("value")||h(J).css("background-color")||"#fff"}function w(J){J=J.originalEvent&&J.originalEvent.touches?J.originalEvent.touches[0]:J;return J.originalEvent?J.originalEvent:J}function s(J){return h(J.find(t.doRender)[0]||J[0])}function v(K){var L=h(this),J=L.offset(),M=h(window),N=t.gap;if(K){j=s(L);i.$trigger=L;(o||q()).css({left:(o[0]._left=J.left)-((o[0]._left=o[0]._left+o[0]._width-(M.scrollLeft()+M.width()))+N>0?o[0]._left+N:0),top:(o[0]._top=J.top+L.outerHeight())-((o[0]._top=o[0]._top+o[0]._height-(M.scrollTop()+M.height()))+N>0?o[0]._top+N:0)}).show(t.animationSpeed,function(){if(K===true){return}f._width=f.width();z._width=z.width();z._height=z.height();l.setColor(m(j[0]));e(true)})}else{h(o).hide(t.animationSpeed,function(){j.blur();i.$trigger=null;e(false)})}}function q(){h("head").append('<style type="text/css">'+(t.css||r)+(t.cssAddon||"")+"</style>");return i.$UI=o=h(d).css({margin:t.margin}).appendTo("body").show(0,function(){var J=h(this);B=t.GPU&&J.css("perspective")!==k;z=h(".cp-xy-slider",this);n=h(".cp-xy-cursor",this);y=h(".cp-z-cursor",this);f=h(".cp-alpha",this).toggle(!!t.opacity);D=h(".cp-alpha-cursor",this);t.buildCallback.call(i,J);J.prepend("<div>").children().eq(0).css("width",J.children().eq(0).width());this._width=this.offsetWidth;this._height=this.offsetHeight}).hide().on(A,".cp-xy-slider,.cp-z-slider,.cp-alpha",H)}function H(K){var J=this.className.replace(/cp-(.*?)(?:\s*|$)/,"$1").replace("-","_");K.preventDefault&&K.preventDefault();K.returnValue=false;j._offset=h(this).offset();(J=J==="xy_slider"?u:J==="z_slider"?p:g)(K);e();F.on(I,function(L){F.off(".a")}).on(b,function(L){J(L);e()})}function u(K){var L=w(K),J=L.pageX-j._offset.left,M=L.pageY-j._offset.top;l.setColor({s:J/z._width*100,v:100-(M/z._height*100)},"hsv")}function p(J){var K=w(J).pageY-j._offset.top;l.setColor({h:360-(K/z._height*360)},"hsv")}function g(K){var J=w(K).pageX-j._offset.left,L=J/f._width;l.setColor({},"rgb",L)}function e(J){var U=l.colors,M=U.hueRGB,O=U.RND.rgb,V=U.RND.hsl,L="#222",Q="#ddd",S=j.data("colorMode"),T=U.alpha!==1,R=Math.round(U.alpha*100)/100,Z=O.r+", "+O.g+", "+O.b,X=(S==="HEX"&&!T?"#"+U.HEX:S==="rgb"||(S==="HEX"&&T)?(!T?"rgb("+Z+")":"rgba("+Z+", "+R+")"):("hsl"+(T?"a(":"(")+V.h+", "+V.s+"%, "+V.l+"%"+(T?", "+R:"")+")")),ab=U.HUELuminance>0.22?L:Q,N=U.rgbaMixBlack.luminance>0.22?L:Q,aa=(1-U.hsv.h)*z._height,Y=U.hsv.s*z._width,W=(1-U.hsv.v)*z._height,ac=R*f._width,ad=B?"translate3d":"",K=j.val(),P=j[0].hasAttribute("value")&&K===""&&J!==k;z._css={backgroundColor:"rgb("+M.r+","+M.g+","+M.b+")"};n._css={transform:ad+"("+Y+"px, "+W+"px, 0)",left:!B?Y:"",top:!B?W:"",borderColor:U.RGBLuminance>0.22?L:Q};y._css={transform:ad+"(0, "+aa+"px, 0)",top:!B?aa:"",borderColor:"transparent "+ab};f._css={backgroundColor:"rgb("+Z+")"};D._css={transform:ad+"("+ac+"px, 0, 0)",left:!B?ac:"",borderColor:N+" transparent"};j._css={backgroundColor:P?"":X,color:P?"":U.rgbaMixBGMixCustom.luminance>0.22?L:Q};j.text=P?"":K!==X?X:"";J!==k?G(J):x(G)}function G(J){z.css(z._css);n.css(n._css);y.css(y._css);f.css(f._css);D.css(D._css);t.doRender&&j.css(j._css);j.text&&j.val(j.text);t.renderCallback.call(i,j,typeof J==="boolean"?J:k)}h.fn.colorPicker=function(J){var K=function(){};J=h.extend({animationSpeed:150,GPU:true,doRender:true,customBG:"#FFF",opacity:true,renderCallback:K,buildCallback:K,body:document.body,scrollResize:true,gap:4},J);!i&&J.scrollResize&&h(window).on("resize.a scroll.a",function(){if(i.$trigger){i.toggle.call(i.$trigger[0],true)}});c=c?c.add(this):this;c.colorPicker=i||(i=new a(J));E+=(E?", ":"")+this.selector;h(J.body).off(".a").on(A,function(M){var L=h(M.target);if(h.inArray(L.closest(E)[0],c)===-1&&!L.closest(o).length){v()}}).on("focus.a click.a",E,v).on("change.a",E,function(){l.setColor(this.value||"#FFF");c.colorPicker.render(true)});return this.each(function(){var M=m(this),N=M.split("("),L=s(h(this));L.data("colorMode",N[1]?N[0].substr(0,3):"HEX").attr("readonly",t.preventFocus);J.doRender&&L.css({"background-color":M,color:function(){return l.setColor(M).rgbaMixBGMixCustom.luminance>0.22?"#222":"#ddd"}})})};h.fn.colorPicker.destroy=function(){h(i.color.options.body).off(".a");i.toggle(false);c=null;E=""}})(jQuery,Colors);