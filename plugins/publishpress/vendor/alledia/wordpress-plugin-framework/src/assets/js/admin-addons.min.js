"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var AllexAddonsTabs=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={currentTab:c.props.currentTab},c.handleClick=c.handleClick.bind(c),c}return _inherits(b,a),_createClass(b,[{key:"handleClick",value:function b(a){a.preventDefault(),this.setState({currentTab:a.target.dataset.tab}),this.props.parentTabClickHandler(a.target.dataset.tab)}},{key:"render",value:function a(){return React.createElement("div",{className:"nav-tab-wrapper"},0<this.props.addonsCount?React.createElement("div",null,React.createElement("a",{href:"#",className:"installed"==this.state.currentTab?"nav-tab nav-tab-active":"nav-tab","data-tab":"installed",onClick:this.handleClick},allexContext.labels.installed),React.createElement("a",{href:"#",className:"missed"==this.state.currentTab?"nav-tab nav-tab-active":"nav-tab","data-tab":"missed",onClick:this.handleClick},allexContext.labels.browse_more)):null)}}]),b}(React.Component),AllexAddonsTable=function(a){function b(a){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return _inherits(b,a),_createClass(b,[{key:"render",value:function c(){var a=this,b=this.props.addons.map(function(b){return b.isInstalled&&"installed"===a.props.currentTab||!b.isInstalled&&"missed"===a.props.currentTab?React.createElement(AllexAddonsRow,{key:"allex_addon_"+b.slug,addon:b,currentTab:a.props.currentTab,nonce:a.props.nonce,pluginName:a.props.pluginName}):null});return React.createElement("section",{id:"allex-addons-"+this.props.currentTab,className:"allex-addons-container"},this.props.addonsCount==this.props.addonsCountTotal?React.createElement("p",{className:"notice allex-addons-all-installed"},allexContext.labels.all_plugins_installed):null,b)}}]),b}(React.Component),AllexAddonsRow=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={licenseKey:c.props.addon.licenseKey,licenseStatus:c.props.addon.licenseStatus,messages:[],showForm:""===c.props.addon.licenseKey,processing:!1},c.onChangeLicenseKey=c.onChangeLicenseKey.bind(c),c.localizeLicenseStatus=c.localizeLicenseStatus.bind(c),c.showForm=c.showForm.bind(c),c.hideForm=c.hideForm.bind(c),c.activateLicenseKey=c.activateLicenseKey.bind(c),c.addMessage=c.addMessage.bind(c),c.focusInput=c.focusInput.bind(c),c}return _inherits(b,a),_createClass(b,[{key:"localizeLicenseStatus",value:function b(a){return null!==a&&""!==a&&"string"==typeof a?allexContext.labels["license_status_"+a]?allexContext.labels["license_status_"+a]:a:""}},{key:"showForm",value:function a(){this.setState({showForm:!0,messages:[]})}},{key:"hideForm",value:function a(){this.setState({showForm:!1,messages:[]})}},{key:"addMessage",value:function c(a){var b=this.state.messages;b.push(a),this.setState({messages:b})}},{key:"focusInput",value:function a(){jQuery("article[data-slug=\""+this.props.addon.slug+"\"] input").focus().select()}},{key:"activateLicenseKey",value:function b(){var a=this;jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"allex_addon_license_validate",key:this.state.licenseKey,plugin_name:this.props.pluginName,addon_name:this.props.addon.slug,addon_edd_id:this.props.addon.eddId,nonce:this.props.nonce},beforeSend:function b(){a.setState({processing:!0,messages:[]})},success:function c(b){return a.setState({processing:!1,licenseStatus:b.license_status}),b.success?"valid"===b.license_status?"valid"===b.license_status?void a.setState({showForm:!1}):void 0:(a.focusInput(),void a.addMessage(a.localizeLicenseStatus(b.license_status))):(a.focusInput(),void a.addMessage(b.message))},error:function d(b,c){a.setState({processing:!1}),a.addMessage(c+". "+allexContext.labels.contact_support)}})}},{key:"onChangeLicenseKey",value:function b(a){this.setState({licenseKey:a.target.value,licenseStatus:"inactive"})}},{key:"render",value:function f(){var a=this,b=this.state.messages.map(function(b,c){var d=a.props.addon.slug+"_"+c;return React.createElement("li",{key:d},b)}),c=this.state.showForm&&"installed"===this.props.currentTab,d="installed"===this.props.currentTab,e=React.createElement("div",{className:"allex-addon-license-form"},React.createElement("div",null,React.createElement("label",null,allexContext.labels.license_key),React.createElement("input",{type:"text",size:"40",maxLength:"32",autoComplete:"false",placeholder:allexContext.labels.enter_license_key,value:this.state.licenseKey,onChange:this.onChangeLicenseKey,disabled:this.state.processing?"disabled":""}),React.createElement("button",{type:"button",className:"button activate",onClick:this.activateLicenseKey,disabled:this.state.processing?"disabled":""},this.state.processing?allexContext.labels.please_wait:allexContext.labels.activate),this.state.processing?React.createElement("div",{className:"lds-dual-ring"}):React.createElement("i",{className:"dashicons dashicons-no-alt",onClick:this.hideForm})),!1===this.state.processing?React.createElement("ul",{className:"allex-addon-messages"},b):null);return React.createElement("article",{"data-slug":this.props.addon.slug},React.createElement("i",{className:this.props.addon.iconClass}),React.createElement("header",null,React.createElement("h3",null,this.props.addon.title),React.createElement("p",null,this.props.addon.description)),c?e:null,"installed"!==this.props.currentTab||c?null:React.createElement("div",{className:"allex-addon-license"},React.createElement("label",null,allexContext.labels.license_key),React.createElement("code",null,this.state.licenseKey),"\xA0",React.createElement("a",{href:"#",onClick:this.showForm},allexContext.labels.change),React.createElement("div",{className:"allex-addon-license-status"},this.localizeLicenseStatus(this.state.licenseStatus))))}}]),b}(React.Component),AllexAddonsContainer=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.state={currentTab:0<c.props.addonsCount?"installed":"missed"},c.handleTabClick=c.handleTabClick.bind(c),c}return _inherits(b,a),_createClass(b,[{key:"handleTabClick",value:function b(a){this.setState({currentTab:a})}},{key:"render",value:function a(){return React.createElement("div",{id:"allex-addons-table",className:this.props.pluginName},React.createElement(AllexAddonsTabs,{addonsCount:this.props.addonsCount,addonsCountTotal:this.props.addonsCountTotal,currentTab:this.state.currentTab,parentTabClickHandler:this.handleTabClick}),"missed"==this.state.currentTab?React.createElement("div",{className:"allex-addons-table-header"},React.createElement("a",{href:this.props.browseMoreUrl,className:"button button-primary",target:"_blank"},allexContext.labels.get_plugins)):null,React.createElement(AllexAddonsTable,{addons:this.props.addons,currentTab:this.state.currentTab,nonce:this.props.nonce,pluginName:this.props.pluginName,addonsCount:this.props.addonsCount,addonsCountTotal:this.props.addonsCountTotal}))}}]),b}(React.Component);

//# sourceMappingURL=admin-addons.min.js.map